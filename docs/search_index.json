[["index.html", "1 Welcome to S2Y Lab 4 Introduction", " S2Y Lab 4 How good is the model? â€“ \\(R^2\\) and residual plots 1 Welcome to S2Y Lab 4 Intended Learning Outcomes: Assess the goodness of fit of linear models based on \\(R^2\\) and \\(R^2\\) (adj); Produce residual plots; Assess the assumptions of a linear model using residual plots. Introduction In the lectures \\(R^2\\) was used to measure the goodness-of-fit of the chosen model, and the idea of residuals was introduced. In today's practical we will use RStudio to find values of \\(R^2\\), and use residual plots to examine the assumptions underlying the linear model. Similarly to previous practicals, we will use the lm() command to fit linear models. We will obtain residuals and standardised residuals from linear models that allow us to check assumptions. We will check our assumptions using: plots of residuals versus fitted values; Normal Q-Q plots; histograms of the residuals. "],["example-1-price-of-diamonds.html", "2 Example 1: Price of diamonds 2.1 Methods Exploratory analysis Statistical analysis", " 2 Example 1: Price of diamonds A sample of 48 diamond rings was obtained in Singapore. The price of each ring and the weight of the diamond stone in the ring were recorded. The data are available in the diamonds.csv file. Our main question of interest is if the price of a diamond ring can be determined from the weight of the diamond stone in the ring. 2.1 Methods We will model the relationship between price and weight using a simple linear regression model and then check if this model is appropriate for the data. The model is given as \\(Y_i = \\alpha + \\beta x_i + \\epsilon_i\\), where (a) the deterministic part of the model captures all the non-random structure in the data; (b) the random errors, \\(\\epsilon_i\\), have constant variance; (c) the random errors, \\(\\epsilon_i\\), are independent; (d) the random errors, \\(\\epsilon_i\\), are normally distributed; (e) the explanatory variable, \\(x\\), is recorded without error. We will consider assumptions (a)-(d) in this practical (assumption (e) cannot be assessed by examining the data). See Chapter 2 of the lecture notes for details of these assumptions. Exploratory analysis Firstly, we will produce a scatterplot of the response variable Price (\\(y\\)), against the predictor variable Weight (\\(x\\)). diamonds &lt;- read.csv(&quot;diamonds.csv&quot;) plot(Price ~ Weight, data = diamonds, xlab = &quot;Weight (carats)&quot;, ylab = &quot;Price (Singapore Dollars)&quot;) Figure 2.1: Scatterplot of Price versus Weight. What can we say about the relationship between Price and Weight? There is a weak positive relationship between weight and price. There is a moderate negative relationship between weight and price. There is a strong positive relationship between weight and price. There is no relationship between weight and price. Statistical analysis A simple linear regression model can be fitted in R using the lm() command. We will fit a simple linear regression model to the diamonds data, with Price as the response variable and Weight as the explanatory variable. This is done using the code: model1 &lt;- lm(Price ~ Weight, data = diamonds) Assumption checking Before assessing the fit of the model, it is important to check that the assumptions underlying the model are satisfied. In order to do this, we need to obtain the residuals after fitting the model. These can be obtained using the commands: with the latter command providing the standardised residuals. These commands can be used to produce a plot of the residuals versus the fitted values and a normal probability plot (Q-Q plot) of the residuals to graphically assess assumptions (a), (b), and (d). The standardised residuals versus fitted values is obtained by: plot(rstandard(model1) ~ fitted(model1)) abline(h=0, lwd=1, lty = 2) Figure 2.2: Standardised residuals versus fitted values from Model1. Figure 2.2 displays the plot of standardised residuals versus fitted values, where we can see that the points are fairly evenly scattered above and below the zero line. The points are slightly grouped together towards the lower fitted values. However, this effect is not very marked and thus it is reasonable to assume that the linear relationship between price and weight captures the non-random structure in the data. This suggests that it is reasonable to assume that the random errors have mean zero and hence that a linear regression model is appropriate in this case. The vertical variation of the points in Figure 2 is fairly constant across the range of the fitted values and does not seem to depend on the fitted values. Hence, it seems reasonable to assume that the random errors have constant variance. The independence of the random errors seems to be a reasonable assumption given that the data were taken from different rings. The normal probability (Q-Q) plot is obtained by using the function qqnorm(), and a line can be added by using the function qqline(). qqnorm(rstandard(model1)) qqline(rstandard(model1), col = &quot;red&quot;, lwd = 2) Figure 2.3: Normal probability (Q-Q) plot from Model1. Figure 2.3 displays the normal probability plot, where we can see that the points lie fairly close to the line of equality (\\(y = x\\)) and so it is reasonable to assume that the random errors are normally distributed. Note that this assumption is required only when we wish to make inferences about the parameters of the model to be applied to some wider population. A histogram of the residuals can be obtained by using the function hist(): hist(rstandard(model1)) Figure 2.4: Histogram of the standardised residuals obtained from Model1. Figure @ref{fig:hist-plot} displays a histogram of the standardised residuals and shows a reasonably bell-shaped curve, and hence normality appears reasonable. Regression output We now examine the regression output by typing: summary(model1) ## ## Call: ## lm(formula = Price ~ Weight, data = diamonds) ## ## Residuals: ## Min 1Q Median 3Q Max ## -85.159 -21.448 -0.869 18.972 79.370 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) -259.63 17.32 -14.99 &lt;2e-16 *** ## Weight 3721.02 81.79 45.50 &lt;2e-16 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 31.84 on 46 degrees of freedom ## Multiple R-squared: 0.9783, Adjusted R-squared: 0.9778 ## F-statistic: 2070 on 1 and 46 DF, p-value: &lt; 2.2e-16 The analysis of variance (ANOVA) table can be produced by using the function anova(). anova(model1) ## Analysis of Variance Table ## ## Response: Price ## Df Sum Sq Mean Sq F value Pr(&gt;F) ## Weight 1 2098596 2098596 2070 &lt; 2.2e-16 *** ## Residuals 46 46636 1014 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 From the summary table output we can see that the regression equation is Price = + \\(\\cdot\\) Weight The value of the coefficient of determination, \\(R^2\\), is 97.83%. This gives us the percentage of variation in Price that is explained by the linear regression model with Weight as a predictor. Hence 97.83% of the variation in the price of a diamond ring is explained by taking into account the weight of the diamond using our simple linear regression model. Hence, the model gives an excellent fit to the data. We can plot the data with the fitted line superimposed, such as in Figure @ref{fig:diamonds-plot-line}, using the command abline() after plotting the data. plot(Price ~ Weight, data = diamonds, xlab = &quot;Weight (carats)&quot;, ylab = &quot;Price (Singapore Dollars)&quot;) abline(model1, col = &quot;red&quot;) Figure 2.5: Scatterplot of Price versus Weight with the fitted line from Model1 superimposed. Conclusion A simple linear regression model has provided an excellent and appropriate model for predicting the price of a diamond ring from the weight of the diamond in the ring. Almost all of the variability in the response has been explained and the assumptions appear justified. "],["exercise-1-hswrestler-dataset.html", "3 Exercise 1: HSWRESTLER dataset 3.1 Assumption checking Regression output", " 3 Exercise 1: HSWRESTLER dataset Recall the HSWRESTLER dataset from Lab 1, which measures the body fat of 78 high school wrestlers using hydrostatic weighing, skin fold measurements and the Tanita body fat scale. Our main question of interest is if hydrostatic fat (hwfat) can be predicted from abdominal fat (abs) and tricep fat (triceps). QUESTION: Produce a scatterplot of the response variable hwfat against the predictor variable abs and triceps. Solution library(PASWR) plot(HWFAT ~ ABS, data = HSwrestler) plot(HWFAT ~ TRICEPS, data = HSwrestler) Build a multiple linear regression model with hwfat as the response variable and abs and triceps as predictor variables. Solution Model &lt;- lm(HWFAT ~ ABS + TRICEPS, data = HSwrestler) 3.1 Assumption checking Produce a plot of the residuals versus the fitted values. Hint Use the function plot() with rstandard() and fitted() for the residuals versus fitted values. Solution plot(rstandard(Model) ~ fitted(Model)) abline(h=0, lwd=1, lty = 2) Which of the following assumptions cannot be checked through the plot of the residuals versus the fitted values? The random errors have mean zero. The random errors have constant variance. The random errors are independent. Based on the plot of standardised residuals versus fitted values, we can see that the points are fairly evenly scattered above and below the zero line. This suggests that it is reasonable to assume that the random errors have mean zero. The vertical variation of the points in this plot is fairly constant across the range of the fitted valuesslightly decreases as fitted values increaseslightly increases as fitted values increase. Hence, it seems very reasonablequite unreasonablevery unreasonable to assume that the random errors have constant variance. (d) Produce a normal probability plot (Q-Q plot) of the residuals. Hint Use the function qqnorm() with the rstandard() function, and add a line with the function qqline(). Solution qqnorm(rstandard(Model)) qqline(rstandard(Model), col = &quot;red&quot;, lwd = 2) From the plot, we can see that the points lie exactly onsomewhat close toaway from the line of equality (\\(y=x\\)). This means that it is very reasonablequite reasonablenot reasonable to assume that the random errors have mean zerothe random errors are independentquite reasonablethe random errors are normally distributed. (e) plot the histogram of residuals. Hint Use the function hist() and rstandard() to plot the histogram of residuals. Solution hist(rstandard(Model)) From the plot above, the histogram showsdoes not show a reasonably bell-shaped curve, and hence the normality assumption appears unreasonablequite reasonable. Regression output (f) Produce the summary table of the regression model and the ANOVA table. Solution ## ## Call: ## lm(formula = HWFAT ~ ABS + TRICEPS, data = HSwrestler) ## ## Residuals: ## Min 1Q Median 3Q Max ## -6.5558 -2.2550 -0.5245 2.3365 9.4957 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 2.05904 0.65219 3.157 0.0023 ** ## ABS 0.33708 0.06415 5.255 1.34e-06 *** ## TRICEPS 0.50430 0.09920 5.084 2.64e-06 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 3.061 on 75 degrees of freedom ## Multiple R-squared: 0.8832, Adjusted R-squared: 0.8801 ## F-statistic: 283.6 on 2 and 75 DF, p-value: &lt; 2.2e-16 ## Analysis of Variance Table ## ## Response: HWFAT ## Df Sum Sq Mean Sq F value Pr(&gt;F) ## ABS 1 5072.8 5072.8 541.365 &lt; 2.2e-16 *** ## TRICEPS 1 242.2 242.2 25.844 2.639e-06 *** ## Residuals 75 702.8 9.4 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 The summary table tells us % of variation in hydrostatic fat can be explained by taking into account abdonimal fat and tricep fat by using a multiple linear regression model. Which of the two statistics, \\(R^2\\) and \\(R^2\\) (adj), is more appropriate to assess the model goodness-of-fit? \\(R^2\\) (adj), because it adjusts for the fact that there is more than one predictor variable in the model. \\(R^2\\), because it can be interpreted more easily. "],["report-task-sugar-in-potatoes.html", "4 REPORT TASK: Sugar in potatoes", " 4 REPORT TASK: Sugar in potatoes Context: Bags of potatoes were stored for various periods of time after lifting. 14 bags were stored and these were then studied after various times in storage to identify the sugar (glucose) content (mg/100gms) of the potatoes. The potatoes were to be used for potato crisp manufacturing and there was interest in identifying the glucose content at specific storage times. Data: potatoesstorage.csv Columns: C1: Glucose - Glucose content (mg/100gms) C2: Weeks - Storage time Read in the data using: potatoes &lt;- read.csv(\"potatoesstorage.csv\") Question of interest: Can the glucose content of potatoes be predicted from the storage time? Tasks Use an appropriate plot to investigate the question of interest. Comment on your plot, making reference to the question of interest. Is it appropriate to calculate a correlation coefficient in this context? Justify your answer. Use an appropriate regression model to investigate the question of interest and comment appropriately. Check the assumptions from your model and comment on how well your model fits the data. State any reservations that you have about your model. Display a plot of your fitted model and use this plot and/or your fitted model equation to obtain a point estimate of the glucose content at two plausible storage times of your choice \\ (Hint: use the lines(Weeks, fitted(model)) command). Produce a statistical report, following the template in the sample report provided, which includes your analyses and comments for the tasks above. Please see the PDF file \"Lab 4: Individual project\" on Moodle (under tab \"Assessments\") for instructions on report submission and sample report. "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
