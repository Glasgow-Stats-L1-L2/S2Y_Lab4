<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Example 1: Price of diamonds | main.knit</title>
  <meta name="description" content="S2Y Lab 4<br />
How good is the model? – <span class="math inline">\(R^2\)</span> and residual plots</div>" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Example 1: Price of diamonds | main.knit" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Example 1: Price of diamonds | main.knit" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="exercise-1-hswrestler-dataset.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="include/webex.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome to S2Y Lab 4</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#intro"><i class="fa fa-check"></i>Introduction</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="example-1-price-of-diamonds.html"><a href="example-1-price-of-diamonds.html"><i class="fa fa-check"></i><b>2</b> Example 1: Price of diamonds</a>
<ul>
<li class="chapter" data-level="2.1" data-path="example-1-price-of-diamonds.html"><a href="example-1-price-of-diamonds.html#methods"><i class="fa fa-check"></i><b>2.1</b> Methods</a></li>
<li class="chapter" data-level="" data-path="example-1-price-of-diamonds.html"><a href="example-1-price-of-diamonds.html#diamonds-3"><i class="fa fa-check"></i>Exploratory analysis</a></li>
<li class="chapter" data-level="" data-path="example-1-price-of-diamonds.html"><a href="example-1-price-of-diamonds.html#diamonds-4"><i class="fa fa-check"></i>Statistical analysis</a>
<ul>
<li class="chapter" data-level="" data-path="example-1-price-of-diamonds.html"><a href="example-1-price-of-diamonds.html#diamonds-as"><i class="fa fa-check"></i>Assumption checking</a></li>
<li class="chapter" data-level="" data-path="example-1-price-of-diamonds.html"><a href="example-1-price-of-diamonds.html#regression"><i class="fa fa-check"></i>Regression output</a></li>
<li class="chapter" data-level="" data-path="example-1-price-of-diamonds.html"><a href="example-1-price-of-diamonds.html#conclusion"><i class="fa fa-check"></i>Conclusion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="exercise-1-hswrestler-dataset.html"><a href="exercise-1-hswrestler-dataset.html"><i class="fa fa-check"></i><b>3</b> Exercise 1: HSWRESTLER dataset</a>
<ul>
<li class="chapter" data-level="3.1" data-path="exercise-1-hswrestler-dataset.html"><a href="exercise-1-hswrestler-dataset.html#assumption-checking"><i class="fa fa-check"></i><b>3.1</b> Assumption checking</a></li>
<li class="chapter" data-level="" data-path="exercise-1-hswrestler-dataset.html"><a href="exercise-1-hswrestler-dataset.html#regression-hs"><i class="fa fa-check"></i>Regression output</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="report-task-sugar-in-potatoes.html"><a href="report-task-sugar-in-potatoes.html"><i class="fa fa-check"></i><b>4</b> REPORT TASK: Sugar in potatoes</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><div class="line-block">S2Y Lab 4<br />
How good is the model? – <span class="math inline">\(R^2\)</span> and residual plots</div></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="example-1-price-of-diamonds" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">2</span> Example 1: Price of diamonds<a href="example-1-price-of-diamonds.html#example-1-price-of-diamonds" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>A sample of 48 diamond rings was obtained in Singapore. The price of each ring and the weight of the diamond stone in the ring were recorded. The data are available in the <code>diamonds.csv</code> file. Our main question of interest is if the price of a diamond ring can be determined from the weight of the diamond stone in the ring.</p>
<div id="methods" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Methods<a href="example-1-price-of-diamonds.html#methods" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We will model the relationship between price and weight using a simple linear regression model and then check if this model is appropriate for the data. The model is given as</p>
<p align="center">
<span class="math inline">\(Y_i = \alpha + \beta x_i + \epsilon_i\)</span>,
</p>
<p>where
(a) the deterministic part of the model captures all the non-random structure in the data;
(b) the random errors, <span class="math inline">\(\epsilon_i\)</span>, have constant variance;
(c) the random errors, <span class="math inline">\(\epsilon_i\)</span>, are independent;
(d) the random errors, <span class="math inline">\(\epsilon_i\)</span>, are normally distributed;
(e) the explanatory variable, <span class="math inline">\(x\)</span>, is recorded without error.</p>
<p>We will consider assumptions (a)-(d) in this practical (assumption (e) cannot be assessed by examining the data). See <strong>Chapter 2</strong> of the lecture notes for details of these assumptions.</p>
</div>
<div id="diamonds-3" class="section level2 unnumbered hasAnchor">
<h2>Exploratory analysis<a href="example-1-price-of-diamonds.html#diamonds-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Firstly, we will produce a scatterplot of the response variable <code>Price</code> (<span class="math inline">\(y\)</span>), against the predictor variable <code>Weight</code> (<span class="math inline">\(x\)</span>).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="example-1-price-of-diamonds.html#cb1-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;diamonds.csv&quot;</span>)</span>
<span id="cb1-2"><a href="example-1-price-of-diamonds.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Price <span class="sc">~</span> Weight, <span class="at">data =</span> diamonds, <span class="at">xlab =</span> <span class="st">&quot;Weight (carats)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Price (Singapore Dollars)&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:diamonds-plot"></span>
<img src="main_files/figure-html/diamonds-plot-1.png" alt="Scatterplot of `Price` versus `Weight`." width="672" />
<p class="caption">
Figure 2.1: Scatterplot of <code>Price</code> versus <code>Weight</code>.
</p>
</div>
<p>What can we say about the relationship between <code>Price</code> and <code>Weight</code>?</p>
<div id="radio_FWQZTOGSRN" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_FWQZTOGSRN" value=""></input> <span>There is a weak positive relationship between weight and price.</span></label><label><input type="radio" autocomplete="off" name="radio_FWQZTOGSRN" value=""></input> <span>There is a moderate negative relationship between weight and price.</span></label><label><input type="radio" autocomplete="off" name="radio_FWQZTOGSRN" value="answer"></input> <span>There is a strong positive relationship between weight and price.</span></label><label><input type="radio" autocomplete="off" name="radio_FWQZTOGSRN" value=""></input> <span>There is no relationship between weight and price.</span></label>
</div>
</div>
<div id="diamonds-4" class="section level2 unnumbered hasAnchor">
<h2>Statistical analysis<a href="example-1-price-of-diamonds.html#diamonds-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A simple linear regression model can be fitted in <code>R</code> using the <code>lm()</code> command.</p>
<p>We will fit a simple linear regression model to the <code>diamonds</code> data, with <code>Price</code> as the response variable and <code>Weight</code> as the explanatory variable. This is done using the code:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="example-1-price-of-diamonds.html#cb2-1" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Weight, <span class="at">data =</span> diamonds)</span></code></pre></div>
<div id="diamonds-as" class="section level3 unnumbered hasAnchor">
<h3>Assumption checking<a href="example-1-price-of-diamonds.html#diamonds-as" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Before assessing the fit of the model, it is important to check that the assumptions underlying the model are satisfied. In order to do this, we need to obtain the residuals after fitting the model. These can be obtained using the commands:</p>
<p>with the latter command providing the standardised residuals. These commands can be used to produce a plot of the residuals versus the fitted values and a normal probability plot (Q-Q plot) of the residuals to graphically assess assumptions (a), (b), and (d).</p>
<p>The standardised residuals versus fitted values is obtained by:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="example-1-price-of-diamonds.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rstandard</span>(model1) <span class="sc">~</span> <span class="fu">fitted</span>(model1))</span>
<span id="cb3-2"><a href="example-1-price-of-diamonds.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lwd=</span><span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:resids-plot"></span>
<img src="main_files/figure-html/resids-plot-1.png" alt="Standardised residuals versus fitted values from `Model1`." width="672" />
<p class="caption">
Figure 2.2: Standardised residuals versus fitted values from <code>Model1</code>.
</p>
</div>
<p>Figure <a href="example-1-price-of-diamonds.html#fig:resids-plot">2.2</a> displays the plot of standardised residuals versus fitted values, where we can see that the points are fairly evenly scattered above and below the zero line. The points are slightly grouped together towards the lower fitted values. However, this effect is not very marked and thus it is reasonable to assume that the linear relationship between price and weight captures the non-random structure in the data. This suggests that it is reasonable to assume that <strong>the random errors have mean zero</strong> and hence that a linear regression model is appropriate in this case.</p>
<p>The vertical variation of the points in Figure 2 is fairly constant across the range of the fitted values and does not seem to depend on the fitted values. Hence, it seems reasonable to assume that <strong>the random errors have constant variance</strong>. The <strong>independence of the random errors</strong> seems to be a reasonable assumption given that the data were taken from different rings.</p>
<p>The normal probability (Q-Q) plot is obtained by using the function <code>qqnorm()</code>, and a line can be added by using the function <code>qqline()</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="example-1-price-of-diamonds.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">rstandard</span>(model1))</span>
<span id="cb4-2"><a href="example-1-price-of-diamonds.html#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">rstandard</span>(model1), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:qq-plot"></span>
<img src="main_files/figure-html/qq-plot-1.png" alt="Normal probability (Q-Q) plot from `Model1`." width="672" />
<p class="caption">
Figure 2.3: Normal probability (Q-Q) plot from <code>Model1</code>.
</p>
</div>
<p>Figure <a href="example-1-price-of-diamonds.html#fig:qq-plot">2.3</a> displays the normal probability plot, where we can see that the points lie fairly close to the line of equality (<span class="math inline">\(y = x\)</span>) and so it is reasonable to assume that <strong>the random errors are normally distributed</strong>. Note that this assumption is required only when we wish to make inferences about the parameters of the model to be applied to some wider population.
A histogram of the residuals can be obtained by using the function <code>hist()</code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="example-1-price-of-diamonds.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">rstandard</span>(model1))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:hist-plot"></span>
<img src="main_files/figure-html/hist-plot-1.png" alt="Histogram of the standardised residuals obtained from `Model1`." width="672" />
<p class="caption">
Figure 2.4: Histogram of the standardised residuals obtained from <code>Model1</code>.
</p>
</div>
<p>Figure @ref{fig:hist-plot} displays a histogram of the standardised residuals and shows a reasonably bell-shaped curve, and hence normality appears reasonable.</p>
</div>
<div id="regression" class="section level3 unnumbered hasAnchor">
<h3>Regression output<a href="example-1-price-of-diamonds.html#regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We now examine the regression output by typing:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="example-1-price-of-diamonds.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Price ~ Weight, data = diamonds)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -85.159 -21.448  -0.869  18.972  79.370 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -259.63      17.32  -14.99   &lt;2e-16 ***
## Weight       3721.02      81.79   45.50   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 31.84 on 46 degrees of freedom
## Multiple R-squared:  0.9783, Adjusted R-squared:  0.9778 
## F-statistic:  2070 on 1 and 46 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>The analysis of variance (ANOVA) table can be produced by using the function <code>anova()</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="example-1-price-of-diamonds.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model1)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: Price
##           Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
## Weight     1 2098596 2098596    2070 &lt; 2.2e-16 ***
## Residuals 46   46636    1014                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>From the summary table output we can see that the regression equation is</p>
<p align="center">
Price = <input class='webex-solveme nospaces' size='7' data-answer='["-259.63"]'/> + <input class='webex-solveme nospaces' size='7' data-answer='["3721.02"]'/> <span class="math inline">\(\cdot\)</span> Weight
</p>
<p>The value of the coefficient of determination, <span class="math inline">\(R^2\)</span>, is 97.83%. This gives us the percentage of variation in <code>Price</code> that is explained by the linear regression model with <code>Weight</code> as a predictor. Hence 97.83% of the variation in the price of a diamond ring is explained by taking into account the weight of the diamond using our simple linear regression model. Hence, the model gives an excellent fit to the data.</p>
<p>We can plot the data with the fitted line superimposed, such as in Figure @ref{fig:diamonds-plot-line}, using the command <code>abline()</code> after plotting the data.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="example-1-price-of-diamonds.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Price <span class="sc">~</span> Weight, <span class="at">data =</span> diamonds, <span class="at">xlab =</span> <span class="st">&quot;Weight (carats)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Price (Singapore Dollars)&quot;</span>)</span>
<span id="cb10-2"><a href="example-1-price-of-diamonds.html#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(model1, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:diamonds-plot-line"></span>
<img src="main_files/figure-html/diamonds-plot-line-1.png" alt="Scatterplot of `Price` versus `Weight` with the fitted line from `Model1` superimposed." width="672" />
<p class="caption">
Figure 2.5: Scatterplot of <code>Price</code> versus <code>Weight</code> with the fitted line from <code>Model1</code> superimposed.
</p>
</div>
</div>
<div id="conclusion" class="section level3 unnumbered hasAnchor">
<h3>Conclusion<a href="example-1-price-of-diamonds.html#conclusion" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A simple linear regression model has provided an excellent and appropriate model for predicting the price of a diamond ring from the weight of the diamond in the ring. Almost all of the variability in the response has been explained and the assumptions appear justified.</p>

</div>
</div>
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;
    
    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");
  
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");
  
  var cl = this.classList
  
  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;
  
  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }
  
  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

window.onload = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }
  
  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
  }

  update_total_correct();
}

</script>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="exercise-1-hswrestler-dataset.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["main.pdf", "main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
